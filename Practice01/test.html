<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" /><!--記得加這行-->
    <title></title>
    <link href="Content/bootstrap.min.css" rel="stylesheet" /> <!--要使用boostrap，要引入-->

    <style>
    </style>
</head>
<body>
    <div class="container">
        <div>
            <canvas id="myChart"></canvas>
        </div>
    </div>
   
    <script src="Scripts/jquery-3.6.3.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.1.2/chart.umd.min.js"></script>

    <script>
        var symbol = "SPY";
        var interval = "WEEKLY";
        $.ajax({
            type: 'get',
            url: 'https://www.alphavantage.co/query?function=TIME_SERIES_MONTHLY&symbol=IBM&apikey=XBRCUGRFRDK9P0HJ',
            success: function (data) {
                console.log(data);
                var chartLegends = [];
                var dataPoints = [];
                var i = 0;
                $.each(data, function (objectTitle, objects) {
                    if (i >= 1) {
                        $.each(objects, function (objectKey, objectValue) {
                            chartLegends.push(objectKey);
                            dataPoints.push(objectValue['4. close']);
                        });
                    }
                    i++;
                });
                //console.log(chartLegends.reverse());
                //console.log(dataPoints.reverse());
                //console.log(data['Meta Data']['2. Symbol']);
                chartLegends.reverse();
                dataPoints.reverse();

                const ctx = document.getElementById('myChart');

                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: chartLegends,
                        datasets: [{
                            label: data['Meta Data']['2. Symbol'],
                            data: dataPoints,
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });


                //var i = 0;
                //$.each(data, function (objectTitle, objects) {

                //    if (i >= 1) {

                //        $.each(objects, function (objectKey, objectValue) {
                //            console.log('');
                //            console.log(objectKey);
                //            console.log('OPEN: ' + objectValue['1. open']);
                //            console.log('HIGH: ' + objectValue['2. high']);
                //            console.log('LOW: ' + objectValue['3. low']);
                //            console.log('CLOSE: ' + objectValue['4. close']);
                //        });
                //    }

                //    i++;
                //});
            },
            error: function () {
                alert('error');
            }
        });
    </script>
    <script src="Scripts/jquery-3.6.1.min.js"></script>  <!--JS有順序性，一定要先放jQuery-->
    <script src="Scripts/bootstrap.bundle.min.js"></script>   <!--4版才有bundle，bundle包含boostrap跟popper-->
</body>
</html>