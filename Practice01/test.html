<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" /><!--記得加這行-->
    <title></title>
    <link href="Content/bootstrap.min.css" rel="stylesheet" /> <!--要使用boostrap，要引入-->

    <style>
    </style>
</head>
<body>
    <div class="container">
        <div class="row row-cols-2 justify-content-around">
            <div class="col">
                <canvas id="lineChart"></canvas>
            </div>
            <div class="col">
                <canvas id="barChart"></canvas>

            </div>
        </div>
    </div>

    <script src="Scripts/jquery-3.6.3.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        var symbol = "SPY";
        var interval = "WEEKLY";
        $.ajax({
            type: 'get',
            url: 'https://www.alphavantage.co/query?function=TIME_SERIES_MONTHLY&symbol=IBM&apikey=XBRCUGRFRDK9P0HJ',
            success: function (data) {
                console.log(data);
                var chartLegends = [];
                var dataPoints = [];
                var i = 0;
                $.each(data, function (objectTitle, objects) {
                    if (i >= 1) {
                        $.each(objects, function (objectKey, objectValue) {
                            chartLegends.push(objectKey);
                            dataPoints.push(objectValue['4. close']);
                        });
                    }
                    i++;
                });
                //console.log(chartLegends.reverse());
                //console.log(dataPoints.reverse());
                //console.log(data['Meta Data']['2. Symbol']);
                chartLegends.reverse();
                dataPoints.reverse();

                const ctx = document.getElementById('lineChart');

                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: chartLegends,
                        datasets: [{
                            label: data['Meta Data']['2. Symbol'],
                            data: dataPoints,
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });


                //var i = 0;
                //$.each(data, function (objectTitle, objects) {

                //    if (i >= 1) {

                //        $.each(objects, function (objectKey, objectValue) {
                //            console.log('');
                //            console.log(objectKey);
                //            console.log('OPEN: ' + objectValue['1. open']);
                //            console.log('HIGH: ' + objectValue['2. high']);
                //            console.log('LOW: ' + objectValue['3. low']);
                //            console.log('CLOSE: ' + objectValue['4. close']);
                //        });
                //    }

                //    i++;
                //});
            },
            error: function () {
                alert('error');
            }
        });
        //BarChart的架構比較清楚簡單
        //Data
        const data = [
            { year: 2010, count: 10 },
            { year: 2011, count: 20 },
            { year: 2012, count: 15 },
            { year: 2013, count: 25 },
            { year: 2014, count: 22 },
            { year: 2015, count: 30 },
            { year: 2016, count: 28 },
        ];
        //Config
        const config = {
            type: 'bar',
            data: {
                labels: data.map(row => row.year),
                datasets: [
                    {
                        label: 'Acquisitions by year',
                        data: data.map(row => row.count)
                    }
                ]
            }
        }
        const barChart = new Chart(
            document.getElementById('barChart'),
            config
        );

           
    </script>
    <script src="Scripts/jquery-3.6.1.min.js"></script>  <!--JS有順序性，一定要先放jQuery-->
    <script src="Scripts/bootstrap.bundle.min.js"></script>   <!--4版才有bundle，bundle包含boostrap跟popper-->
</body>
</html>